---

title: FAIMED 3D


keywords: fastai
sidebar: home_sidebar

summary: "use fastai to train fully three-dimensional models on radiological data quickly"
description: "use fastai to train fully three-dimensional models on radiological data quickly"
nb_path: "nbs/index.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/index.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Classification">Classification<a class="anchor-link" href="#Classification"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">faimed3d.all</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Load data in various medical formats (DICOM, NIfTI, NRRD) or even videos as simple as in fastai.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../data/radiopaedia_cases.csv&#39;</span><span class="p">)</span>
<span class="n">dls</span> <span class="o">=</span> <span class="n">ImageDataLoaders3D</span><span class="o">.</span><span class="n">from_df</span><span class="p">(</span><span class="n">d</span><span class="p">,</span>
                                 <span class="n">item_tfms</span> <span class="o">=</span> <span class="n">Resize3D</span><span class="p">((</span><span class="mi">20</span><span class="p">,</span> <span class="mi">112</span><span class="p">,</span> <span class="mi">112</span><span class="p">)),</span>
                                 <span class="n">batch_tfms</span> <span class="o">=</span> <span class="n">aug_transforms_3d</span><span class="p">(),</span> 
                                 <span class="n">bs</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">val_bs</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Faimed3d provides multiple pre-trained model architectures for quick transfer learning.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span> <span class="o">=</span> <span class="n">cnn_learner_3d</span><span class="p">(</span><span class="n">dls</span><span class="p">,</span> <span class="n">efficientnet_b0</span><span class="p">)</span> 
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">lr_find</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>SuggestedLRs(lr_min=0.017378008365631102, lr_steep=9.12010818865383e-07)</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Click <a href="../examples/3d_classification.md">here</a> for a more in-depth classification example.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Segmentation">Segmentation<a class="anchor-link" href="#Segmentation"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dls</span> <span class="o">=</span> <span class="n">SegmentationDataLoaders3D</span><span class="o">.</span><span class="n">from_df</span><span class="p">(</span><span class="n">d</span><span class="p">,</span>
                                 <span class="n">item_tfms</span> <span class="o">=</span> <span class="n">Resize3D</span><span class="p">((</span><span class="mi">20</span><span class="p">,</span> <span class="mi">112</span><span class="p">,</span> <span class="mi">112</span><span class="p">)),</span>
                                 <span class="n">batch_tfms</span> <span class="o">=</span> <span class="n">aug_transforms_3d</span><span class="p">(),</span> 
                                 <span class="n">bs</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">val_bs</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>All models in faimed3d can be used as a backbone for U-Nets, even with pre-trained weights.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span> <span class="o">=</span> <span class="n">unet_learner_3d</span><span class="p">(</span><span class="n">dls</span><span class="p">,</span> <span class="n">efficientnet_b0</span><span class="p">,</span> <span class="n">n_out</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span> 
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">RuntimeError</span>                              Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-14-3dbaa2a15c56&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>learn <span class="ansi-blue-fg">=</span> unet_learner_3d<span class="ansi-blue-fg">(</span>dls<span class="ansi-blue-fg">,</span> efficientnet_b0<span class="ansi-blue-fg">,</span> n_out <span class="ansi-blue-fg">=</span> <span class="ansi-cyan-fg">2</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">~/Documents/faimed3d/nbs/faimed3d/learner.py</span> in <span class="ansi-cyan-fg">unet_learner_3d</span><span class="ansi-blue-fg">(dls, arch, normalize, n_out, pretrained, config, loss_func, opt_func, lr, splitter, cbs, metrics, path, model_dir, wd, wd_bn_bias, train_bn, moms, norm_type, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">     67</span>     img_size <span class="ansi-blue-fg">=</span> dls<span class="ansi-blue-fg">.</span>one_batch<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">[</span><span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">.</span>shape<span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">-</span><span class="ansi-cyan-fg">3</span><span class="ansi-blue-fg">:</span><span class="ansi-blue-fg">]</span>
<span class="ansi-green-intense-fg ansi-bold">     68</span>     <span class="ansi-green-fg">assert</span> img_size<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">&#34;image size could not be inferred from data&#34;</span>
<span class="ansi-green-fg">---&gt; 69</span><span class="ansi-red-fg">     </span>model <span class="ansi-blue-fg">=</span> create_unet_model_3d<span class="ansi-blue-fg">(</span>arch<span class="ansi-blue-fg">,</span> n_out<span class="ansi-blue-fg">,</span> img_size<span class="ansi-blue-fg">,</span> dls<span class="ansi-blue-fg">.</span>n_inp<span class="ansi-blue-fg">,</span> pretrained<span class="ansi-blue-fg">=</span>pretrained<span class="ansi-blue-fg">,</span> norm_type<span class="ansi-blue-fg">=</span>norm_type<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     70</span> 
<span class="ansi-green-intense-fg ansi-bold">     71</span>     <span class="ansi-green-fg">if</span> loss_func <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">:</span> loss_func <span class="ansi-blue-fg">=</span> DiceLoss<span class="ansi-blue-fg">(</span>smooth<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">0.</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">~/Documents/faimed3d/nbs/faimed3d/learner.py</span> in <span class="ansi-cyan-fg">create_unet_model_3d</span><span class="ansi-blue-fg">(arch, n_out, img_size, n_inp, pretrained, cut, n_in, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">     44</span>     meta <span class="ansi-blue-fg">=</span> model_meta<span class="ansi-blue-fg">.</span>get<span class="ansi-blue-fg">(</span>arch<span class="ansi-blue-fg">,</span> _default_meta<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     45</span>     body <span class="ansi-blue-fg">=</span> create_body<span class="ansi-blue-fg">(</span>arch<span class="ansi-blue-fg">,</span> n_in<span class="ansi-blue-fg">,</span> pretrained<span class="ansi-blue-fg">,</span> ifnone<span class="ansi-blue-fg">(</span>cut<span class="ansi-blue-fg">,</span> meta<span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">&#39;cut&#39;</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">---&gt; 46</span><span class="ansi-red-fg">     </span>model <span class="ansi-blue-fg">=</span> DynamicUnet3D<span class="ansi-blue-fg">(</span>body<span class="ansi-blue-fg">,</span> n_out<span class="ansi-blue-fg">,</span> img_size<span class="ansi-blue-fg">,</span> n_inp<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     47</span>     <span class="ansi-green-fg">return</span> model
<span class="ansi-green-intense-fg ansi-bold">     48</span> 

<span class="ansi-green-fg">~/anaconda3/envs/fastai-v2/lib/python3.8/site-packages/fastcore/meta.py</span> in <span class="ansi-cyan-fg">__call__</span><span class="ansi-blue-fg">(cls, *args, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">     36</span>         <span class="ansi-green-fg">if</span> type<span class="ansi-blue-fg">(</span>res<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">==</span>cls<span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">     37</span>             <span class="ansi-green-fg">if</span> hasattr<span class="ansi-blue-fg">(</span>res<span class="ansi-blue-fg">,</span><span class="ansi-blue-fg">&#39;__pre_init__&#39;</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span> res<span class="ansi-blue-fg">.</span>__pre_init__<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>args<span class="ansi-blue-fg">,</span><span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">---&gt; 38</span><span class="ansi-red-fg">             </span>res<span class="ansi-blue-fg">.</span>__init__<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>args<span class="ansi-blue-fg">,</span><span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     39</span>             <span class="ansi-green-fg">if</span> hasattr<span class="ansi-blue-fg">(</span>res<span class="ansi-blue-fg">,</span><span class="ansi-blue-fg">&#39;__post_init__&#39;</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span> res<span class="ansi-blue-fg">.</span>__post_init__<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>args<span class="ansi-blue-fg">,</span><span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     40</span>         <span class="ansi-green-fg">return</span> res

<span class="ansi-green-fg">~/Documents/faimed3d/nbs/faimed3d/models/unet.py</span> in <span class="ansi-cyan-fg">__init__</span><span class="ansi-blue-fg">(self, encoder, n_out, img_size, n_inp, blur, blur_final, self_attention, y_range, last_cross, bottle, act_cls, init, norm_type, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    115</span>                                      act_cls=act_cls, init=init, norm_type=norm_type, **kwargs).eval()
<span class="ansi-green-intense-fg ansi-bold">    116</span>             layers<span class="ansi-blue-fg">.</span>append<span class="ansi-blue-fg">(</span>unet_block<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">--&gt; 117</span><span class="ansi-red-fg">             </span>x <span class="ansi-blue-fg">=</span> unet_block<span class="ansi-blue-fg">(</span>x<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    118</span> 
<span class="ansi-green-intense-fg ansi-bold">    119</span>         ni <span class="ansi-blue-fg">=</span> x<span class="ansi-blue-fg">.</span>shape<span class="ansi-blue-fg">[</span><span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">]</span>

<span class="ansi-green-fg">~/anaconda3/envs/fastai-v2/lib/python3.8/site-packages/torch/nn/modules/module.py</span> in <span class="ansi-cyan-fg">_call_impl</span><span class="ansi-blue-fg">(self, *input, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    725</span>             result <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>_slow_forward<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>input<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    726</span>         <span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 727</span><span class="ansi-red-fg">             </span>result <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>forward<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>input<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    728</span>         for hook in itertools.chain(
<span class="ansi-green-intense-fg ansi-bold">    729</span>                 _global_forward_hooks<span class="ansi-blue-fg">.</span>values<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span>

<span class="ansi-green-fg">~/Documents/faimed3d/nbs/faimed3d/models/unet.py</span> in <span class="ansi-cyan-fg">forward</span><span class="ansi-blue-fg">(self, up_in)</span>
<span class="ansi-green-intense-fg ansi-bold">     53</span>         <span class="ansi-green-fg">if</span> ssh <span class="ansi-blue-fg">!=</span> up_out<span class="ansi-blue-fg">.</span>shape<span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">-</span><span class="ansi-cyan-fg">3</span><span class="ansi-blue-fg">:</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">     54</span>             up_out <span class="ansi-blue-fg">=</span> F<span class="ansi-blue-fg">.</span>interpolate<span class="ansi-blue-fg">(</span>up_out<span class="ansi-blue-fg">,</span> s<span class="ansi-blue-fg">.</span>shape<span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">-</span><span class="ansi-cyan-fg">3</span><span class="ansi-blue-fg">:</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">,</span> mode<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">&#39;nearest&#39;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">---&gt; 55</span><span class="ansi-red-fg">         </span>cat_x <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>relu<span class="ansi-blue-fg">(</span>torch<span class="ansi-blue-fg">.</span>cat<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">[</span>up_out<span class="ansi-blue-fg">,</span> self<span class="ansi-blue-fg">.</span>bn<span class="ansi-blue-fg">(</span>s<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">,</span> dim<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     56</span>         <span class="ansi-green-fg">return</span> self<span class="ansi-blue-fg">.</span>conv2<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>conv1<span class="ansi-blue-fg">(</span>cat_x<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     57</span> 

<span class="ansi-green-fg">~/anaconda3/envs/fastai-v2/lib/python3.8/site-packages/torch/nn/modules/module.py</span> in <span class="ansi-cyan-fg">_call_impl</span><span class="ansi-blue-fg">(self, *input, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    725</span>             result <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>_slow_forward<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>input<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    726</span>         <span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 727</span><span class="ansi-red-fg">             </span>result <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>forward<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>input<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    728</span>         for hook in itertools.chain(
<span class="ansi-green-intense-fg ansi-bold">    729</span>                 _global_forward_hooks<span class="ansi-blue-fg">.</span>values<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span>

<span class="ansi-green-fg">~/anaconda3/envs/fastai-v2/lib/python3.8/site-packages/torch/nn/modules/batchnorm.py</span> in <span class="ansi-cyan-fg">forward</span><span class="ansi-blue-fg">(self, input)</span>
<span class="ansi-green-intense-fg ansi-bold">    129</span>         used <span class="ansi-green-fg">for</span> normalization <span class="ansi-blue-fg">(</span>i<span class="ansi-blue-fg">.</span>e<span class="ansi-blue-fg">.</span> <span class="ansi-green-fg">in</span> eval mode when buffers are <span class="ansi-green-fg">not</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>
<span class="ansi-green-intense-fg ansi-bold">    130</span>         &#34;&#34;&#34;
<span class="ansi-green-fg">--&gt; 131</span><span class="ansi-red-fg">         return F.batch_norm(
</span><span class="ansi-green-intense-fg ansi-bold">    132</span>             input<span class="ansi-blue-fg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    133</span>             <span class="ansi-red-fg"># If buffers are not to be tracked, ensure that they won&#39;t be updated</span>

<span class="ansi-green-fg">~/anaconda3/envs/fastai-v2/lib/python3.8/site-packages/torch/nn/functional.py</span> in <span class="ansi-cyan-fg">batch_norm</span><span class="ansi-blue-fg">(input, running_mean, running_var, weight, bias, training, momentum, eps)</span>
<span class="ansi-green-intense-fg ansi-bold">   2054</span>         _verify_batch_size<span class="ansi-blue-fg">(</span>input<span class="ansi-blue-fg">.</span>size<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   2055</span> 
<span class="ansi-green-fg">-&gt; 2056</span><span class="ansi-red-fg">     return torch.batch_norm(
</span><span class="ansi-green-intense-fg ansi-bold">   2057</span>         input<span class="ansi-blue-fg">,</span> weight<span class="ansi-blue-fg">,</span> bias<span class="ansi-blue-fg">,</span> running_mean<span class="ansi-blue-fg">,</span> running_var<span class="ansi-blue-fg">,</span>
<span class="ansi-green-intense-fg ansi-bold">   2058</span>         training<span class="ansi-blue-fg">,</span> momentum<span class="ansi-blue-fg">,</span> eps<span class="ansi-blue-fg">,</span> torch<span class="ansi-blue-fg">.</span>backends<span class="ansi-blue-fg">.</span>cudnn<span class="ansi-blue-fg">.</span>enabled

<span class="ansi-red-fg">RuntimeError</span>: running_mean should contain 320 elements not 112</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">lr_find</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Click <a href="../examples/3d_segmentation.md">here</a> for a more in-depth segmentation example.</p>

</div>
</div>
</div>
</div>
 

